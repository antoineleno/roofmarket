
<!-- Home page-->

{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
    <!-- Header Start -->
    <div class="container-fluid header bg-white p-0">
        <div class="row g-0 align-items-center flex-column-reverse flex-md-row">
            <div class="col-md-6 p-5 mt-lg-5">
                <h1 class="display-5 animated fadeIn mb-4">Find A <span class="text-primary">Perfect Home</span> To Live With Your Family</h1>
                <p class="animated fadeIn mb-4 pb-2">Discover Your Ideal Home for You and Your Loved Ones. Explore a wide selection of properties tailored to your family's comfort and lifestyle.</p>
                <a href="{{ url_for('app_view_property.property_list') }}" class="btn btn-primary py-3 px-5 me-3 animated fadeIn">Get Started</a>
            </div>
            <div class="col-md-6 animated fadeIn">
                <div class="owl-carousel header-carousel">
                    <div class="owl-carousel-item">
                        <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/carousel-1.jpg') }}" alt="">
                    </div>
                    <div class="owl-carousel-item">
                        <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/carousel-2.jpg') }}" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header End -->

    <!-- Search Start -->
    <div class="container-fluid bg-primary mb-5 wow fadeIn" data-wow-delay="0.1s" style="padding: 35px;">
        <div class="container">
            <div class="row">
              <div class="col-sm">
                <select class="form-select border-0 py-3" id="country_search">
                    <option selected disabled>Select a country</option>
                    {% for country in countries %}
                    <option value="{{ country }}">{{ country }}</option>
                    {% endfor %}
                </select>
              </div>
              <div class="col-sm">
                <select class="form-select border-0 py-3" id="city_search">
                    <option selected disabled>Select a city</option>
                </select>
              </div>
              <div class="col-sm">
                <select class="form-select border-0 py-3" id="type_search">
                    <option selected>Property Type</option>
                    <option value="apartment">apartment</option>
                    <option value="house">house</option>
                    <option value="studio">studio</option>
                    <option value="villa">villa</option>
                </select>
              </div>
              <div class="col-sm">
                <input type="text" class="form-control border-0 py-3" placeholder="Price Range" id="priceRangeInput" readonly data-bs-toggle="modal" data-bs-target="#priceRangeModal">
              </div>
    
              <!-- Modal for the price range slider -->
        <div class="modal fade" id="priceRangeModal" tabindex="-1" aria-labelledby="priceRangeModalLabel" aria-hidden="true">
            <div class="modal-dialog custom-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="priceRangeModalLabel">Select Price Range</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <label for="priceRange" class="form-label">Price Range:</label>
                        <div class="d-flex justify-content-between">
                            <span id="minPriceDisplay">$0</span>
                            <span id="maxPriceDisplay">$1000+</span>
                        </div>
                        <div class="range-slider mt-3">
                            <input type="range" class="form-range" min="0" max="1000000" step="50" id="minPrice" value="100">
                            <input type="range" class="form-range" min="0" max="1000000" step="50" id="maxPrice" value="900">
                        </div>
                        <div class="text-center mt-2">
                            <span id="selectedRange">Selected: $100 - $900</span>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="applyPriceRange" data-bs-dismiss="modal">Apply</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
              <div class="col-sm">
                <a href="" id="search_bric" ><button class="btn btn-dark border-0 w-100 py-3" id="search_bric_btn">Search</button></a>  
              </div>
            </div>
          </div>
    </div>
    <!-- Search End -->


    <!-- Category Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 600px;">
                <h1 class="mb-3">Property Types</h1>
                <p>Explore a Variety of Property Types. Whether you're looking for a cozy apartment, a spacious villa, or a commercial space, we offer a range of options to suit your needs.</p>
            </div>
            <div class="row g-4">
                <div class="col-lg-3 col-sm-6 wow fadeInUp" data-wow-delay="0.1s">
                    <a class="cat-item d-block bg-light text-center rounded p-3" href="{{ url_for('app_view_property.property_list', type='apartment') }}">
                        <div class="rounded p-4">
                            <div class="icon mb-3">
                                <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/icon-apartment.png') }}" alt="Icon">
                            </div>
                            <h6>Apartment</h6>
                            <span>{{ Number_per_type.apartment }} Properties</span>
                        </div>
                    </a>
                </div>
                <div class="col-lg-3 col-sm-6 wow fadeInUp" data-wow-delay="0.3s">
                    <a class="cat-item d-block bg-light text-center rounded p-3" href="{{ url_for('app_view_property.property_list', type='villa') }}">
                        <div class="rounded p-4">
                            <div class="icon mb-3">
                                <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/icon-villa.png') }}" alt="Icon">
                            </div>
                            <h6>Villa</h6>
                            <span>{{ Number_per_type.villa }} Properties</span>
                        </div>
                    </a>
                </div>
                <div class="col-lg-3 col-sm-6 wow fadeInUp" data-wow-delay="0.5s">
                    <a class="cat-item d-block bg-light text-center rounded p-3" href="{{ url_for('app_view_property.property_list', type='house') }}">
                        <div class="rounded p-4">
                            <div class="icon mb-3">
                                <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/icon-house.png') }}" alt="Icon">
                            </div>
                            <h6>House</h6>
                            <span>{{ Number_per_type.house }} Properties</span>
                        </div>
                    </a>
                </div>
                <div class="col-lg-3 col-sm-6 wow fadeInUp" data-wow-delay="0.7s">
                    <a class="cat-item d-block bg-light text-center rounded p-3" href="{{ url_for('app_view_property.property_list', type='studio') }}">
                        <div class="rounded p-4">
                            <div class="icon mb-3">
                                <img class="img-fluid" src="{{ url_for('app_view_home.static', filename='img/icon-housing.png') }}" alt="Icon">
                            </div>
                            <h6>Studio</h6>
                            <span>{{ Number_per_type.studio }} Properties</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- Category End -->


    <!-- About Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5 align-items-center">
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.1s">
                    <div class="about-img position-relative overflow-hidden p-5 pe-0">
                        <img class="img-fluid w-100" src="{{ url_for('app_view_home.static', filename='img/about.jpg') }}">
                    </div>
                </div>
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
                    <h1 class="mb-4">#1 Place To Find The Perfect Property</h1>
                    <p class="mb-4">Explore a diverse range of properties tailored to your lifestyle, whether you're buying, selling or renting. At RoofMarket, we make it easy to find a home that fits your needs, offering</p>
                    <p><i class="fa fa-check text-primary me-3"></i>A wide selection of homes in prime locations</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Seamless browsing and property comparison</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Personalized support to guide you every step of the way</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Become a leasing agent</p>
                    <a class="btn btn-primary py-3 px-5 mt-3" href="{{ url_for('app_view_property.property_list') }}">Start your journey to your dream property today!</a>
                </div>
            </div>
        </div>
    </div>
    <!-- About End -->


    <!-- Property List Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-0 gx-5 align-items-end">
                <div class="col-lg-6">
                    <div class="text-start mx-auto mb-5 wow slideInLeft" data-wow-delay="0.1s">
                        <h1 class="mb-3">Property Listing</h1>
                        <p>Explore our extensive selection of properties available for sale, featuring modern amenities and prime locations that cater to your lifestyle needs.</p>
                    </div>
                </div>
                <div class="col-lg-6 text-start text-lg-end wow slideInRight" data-wow-delay="0.1s">
                    <ul class="nav nav-pills d-inline-flex justify-content-end mb-5">
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-primary {% if feature == 'featured' %} active {% endif %}" href="{{ url_for('app_view_home.home', feature='featured') }}">Featured</a>
                        </li>
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-primary {% if feature == 'sell' %} active {% endif %}" href="{{ url_for('app_view_home.home', feature='sell') }}">For Sell</a>
                        </li>
                        <li class="nav-item me-0">
                            <a class="btn btn-outline-primary {% if feature == 'rent' %} active {% endif %}"  href="{{ url_for('app_view_home.home', feature='rent') }}">For Rent</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-content">
                <div id="tab-1" class="tab-pane fade show p-0 active">
                    <div class="row g-4">

                        {% for property in properties %}

                        <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="{{ 0.2 * loop.index }}s">
                            <div class="property-item rounded overflow-hidden">
                                <a href="{{ url_for('app_view_property.property_onclick', property_id=property.id)}}"> <!-- Link to property.htm -->
                                    <div class="position-relative overflow-hidden">
                                        <img class="img-fluid" src="../{{ property.Main_image_url }}" alt="Main property image">
                                        <div class="bg-primary rounded text-white position-absolute start-0 top-0 m-4 py-1 px-3">For {{ property.listing_type }}</div>
                                        <div class="bg-white rounded-top text-primary position-absolute start-0 bottom-0 mx-4 pt-1 px-3">{{ property.property_type }}</div>
                                    </div>
                                    <div class="p-4 pb-0">
                                        <h5 class="text-primary mb-3">${{ property.price }}</h5>
                                        <span class="d-block h5 mb-2">{{ property.title }} For Sell</span>
                                        <p><i class="fa fa-map-marker-alt text-primary me-2"></i>{{ property.address }}, {{ property.city}}, {{ property.country }}</p>
                                    </div>
                                    <div class="d-flex border-top">
                                        <small class="flex-fill text-center border-end py-2"><i class="fa fa-ruler-combined text-primary me-2"></i> {{ property.area}} Sqft</small>
                                        <small class="flex-fill text-center border-end py-2"><i class="fa fa-bed text-primary me-2"></i> {{ property.bedrooms }} Bed</small>
                                        <small class="flex-fill text-center py-2"><i class="fa fa-bath text-primary me-2"></i> {{ property.bathrooms }} Bath</small>
                                    </div>
                                </a> <!-- End of link -->
                            </div>
                        </div>  
                        
                        {% endfor %}
                                                  
                        <div class="col-12 text-center wow fadeInUp" data-wow-delay="0.1s">
                            <a class="btn btn-primary py-3 px-5" href="{{ url_for('app_view_property.property_list') }}">Browse More Property</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Property List End -->



        <!-- Search -->
        <script>
            document.getElementById('country_search').addEventListener('change', async function() {
                const country = this.value;  // Get the selected country
                const citySelect = document.getElementById('city_search');
                
                // Clear previous cities
                citySelect.innerHTML = '<option selected disabled>Select a city</option>';
            
                if (country) {
                    // Fetch cities based on the selected country
                    const response = await fetch(`/get_cities/${country}`);
                    const cities = await response.json();
            
                    // Populate the city dropdown with the retrieved cities
                    cities.forEach(city => {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                }
            });
            </script>
    
            
            <script>
                const search_bric = document.getElementById("search_bric");
                const search_bric_btn = document.getElementById("search_bric_btn");
                const country_search = document.getElementById("country_search");
                const city_search = document.getElementById("city_search");
                const type_search = document.getElementById("type_search");
                const maxPrice = document.getElementById("maxPrice");
                const minPrice = document.getElementById("minPrice");
            
                // Function to update the link's href or disable it if criteria are not met
                function updateSearchLink() {
                    // Get the values from each input
                    const countryValue = country_search.value;
                    const cityValue = city_search.value;
                    const typeValue = type_search.value;
                    const maxPriceValue = maxPrice.value;
                    const minPriceValue = minPrice.value;
            
                    // Check if required fields are selected
                    if (countryValue == "Select a country" || cityValue == "Select a city" || typeValue == "Property Type") {
                        // Disable the link by preventing the default action
                        search_bric.removeAttribute("href");  // Remove the href attribute
                        //search_bric.classList.add("disabled-link"); // Optionally style it as disabled
                    } else {
                        // Set the href attribute with the updated values
                        search_bric.setAttribute("href", `/property/property_list?type=${typeValue}&country=${countryValue}&city=${cityValue}&max_price=${maxPriceValue}&min_price=${minPriceValue}`);
                        //search_bric.classList.remove("disabled-link"); // Remove disabled styling if previously applied
                    }
                }
            
                // Add the event listener for mouseover
                search_bric_btn.addEventListener("mouseover", updateSearchLink);
            </script>
            
            <!-- Search end -->
{% endblock %}
